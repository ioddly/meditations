
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Internals Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="notes.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="habits.html">
            
                <a href="habits.html">
            
                    
                    Habits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="notes.html">
            
                <a href="notes.html">
            
                    
                    Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4" data-path="internals.html">
            
                <a href="internals.html">
            
                    
                    Internals
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Internals</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="api-documentation">API documentation</h3>
<p>Both the TypeScript and Go APIs are semi-documented. Use <code>yarn run doc-frontend</code> and <code>yarn run
doc-backend</code> to open them.</p>
<h3 id="database">Database</h3>
<p>There are three tables relating to habits: tasks, comments (one-to-one relationship with tasks),
and scopes.</p>
<p>In the documentation and code comments, a &quot;scope&quot; is considered a time-based or project-based
container of tasks. So July 3, 2017 could be a daily scope, July 2017 could be a monthly scope,
there could be a project called &quot;Bucket List&quot; which is also referred to as a scope, and so on.</p>
<p>The scope table contains three dummy rows for daily, monthly, and yearly tasks and an unlimited
number of rows after that which are used to store project names.</p>
<p>So a task&apos;s scope is, in actuality, a combination of its SCOPE and DATE columns. For example, a
daily task created on July 3, 2017 would have a SCOPE of 1 and a DATE of 2017-07-03, and
meditations would mount it under the daily task column by querying for all tasks with this date
and scope.</p>
<p>This is somewhat confusing and the database is organized this way mostly for historical reasons.</p>
<p>The journal has three tables: entries, tags, and entrytags, whose meaning is self-evident.</p>
<h3 id="code-organization">Code organization</h3>
<p>Backend code is located in backend/</p>
<ul>
<li>app.go contains the entry point and command line interface</li>
<li>database.go contains database migration and repair</li>
<li>habits.go contains the bulk of the habits backend code, but</li>
<li>habitsweb.go contains the web methods and routing for habits</li>
<li>journal.go contains both the backend and web interface of the journal</li>
<li>journal_sidebar.go contains the Journal sidebar synchronization code</li>
<li>sync.go contains convenience method for establishing WebSockets</li>
</ul>
<p>Frontend code is located in src/</p>
<ul>
<li>bindings.d.ts - TypeScript type declarations for medium-editor-tables and riot-route</li>
<li>entry/ contains the webpack entry points. </li>
<li><p>common.tsx contains all methods used by both Habits and Journal.</p>
</li>
<li><p>habits/ and journal/ contain the frontend code for Habits and Journal respectively.</p>
<p>Each of them have a &apos;state.ts&apos; file containing backend type definitions and Redux state, a
&apos;main.tsx&apos; file containing WebSocket and routing handling, and a &apos;components.tsx&apos; file
containing most components. In some cases components are further split up into their own files.</p>
</li>
</ul>
<p>Meditations uses WebSockets to synchronize UI across multiple clients. GET requests result in
JSON data being sent in response, and are used to do things like initialize the UI. POST requests
result in new information being sent over the relevant WebSocket, if any needs to be sent in
response to an action that has occurred. Contra REST, POST methods do not necessarily result in
data being created or modified.</p>
<h3 id="reading-the-source-code">Reading the source code</h3>
<p>To start understanding how meditations works &quot;under the hood,&quot; the best place to start would be
the end of habitsweb.go and journal.go, and the main.tsx file for habits/ and journal/, which is
where the routing logic and initialization for the backend and frontend live.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="notes.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Notes">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Internals","level":"1.4","depth":1,"previous":{"title":"Notes","level":"1.3","depth":1,"path":"notes.md","ref":"notes.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"internals.md","mtime":"2017-11-24T00:57:45.705Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-11-24T01:01:22.733Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

